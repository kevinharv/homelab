---

# Pre-reqs
# - pin kubeadm, kubelet, kubectl versions to same for install


# Common TASKS

- name: Disable SELinux
  ansible.posix.selinux:
    state: disabled

- name: Disable swap on running system
  command: swapoff -a
  become: true

- name: Disable swap in configuration
  replace:
    path: /etc/fstab
    regexp: '^(\s*)([^#\n]+\s+)(\w+\s+)swap(\s+.*)$'
    replace: '#\1\2\3swap\4'
    backup: yes
    
# Install containerd container runtime


# KUBERNETES INSTALLATION
# Add Kubernetes repo
# Install kubelet kubeadm kubectl
# Enable kubelet service

# Init cluster on one control plane node - need to do checks to make idempotent
# Join additional control plane - setup HA
# Join worker nodes
